<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bentok Lottere - HOTS Kedokteran PTN</title>
  <style>
    :root {
      --primary: #1e40af;
      --primary-dark: #1e3a8a;
      --success: #22c55e;
      --danger: #ef4444;
      --warning: #f59e0b;
      --light: #f3f4f6;
      --dark: #111827;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #e0f2fe, #dbeafe);
      color: var(--dark);
      min-height: 100vh;
      padding: 20px;
      line-height: 1.5;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.12);
      overflow: hidden;
    }
    header {
      background: var(--primary);
      color: white;
      padding: 2rem 1.5rem;
      text-align: center;
    }
    h1 { margin-bottom: 0.5rem; font-size: 2.2rem; }
    .menu, .game-area { padding: 2.5rem 2rem; text-align: center; }
    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 1.1rem 2.8rem;
      margin: 1rem 1rem;
      border-radius: 12px;
      font-size: 1.35rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }
    button:hover { background: var(--primary-dark); transform: translateY(-3px); }
    #score-board {
      font-size: 1.8rem;
      font-weight: bold;
      margin: 1.5rem 0;
      color: var(--primary);
    }
    #timer {
      font-size: 2rem;
      font-weight: bold;
      color: var(--danger);
      margin: 1rem 0;
    }
    #soal-text {
      font-size: 1.35rem;
      line-height: 1.8;
      margin: 1.5rem 0;
      text-align: left;
    }
    .options {
      display: grid;
      gap: 1rem;
      margin: 2rem 0;
    }
    .option {
      background: var(--light);
      padding: 1.3rem;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.25s;
      font-size: 1.15rem;
      border: 2px solid transparent;
      text-align: left;
    }
    .option:hover { background: #dbeafe; border-color: var(--primary); }
    #feedback {
      padding: 1.8rem;
      border-radius: 12px;
      margin: 2rem 0;
      font-size: 1.2rem;
      line-height: 1.6;
    }
    .correct   { background: #ecfccb; color: #166534; }
    .wrong     { background: #fee2e2; color: #991b1b; }
    .time-up   { background: #fef3c7; color: #92400e; }
    .hidden { display: none; }
    footer {
      text-align: center;
      padding: 1.5rem;
      color: #6b7280;
      font-size: 0.95rem;
    }
  </style>
</head>
<body>

<div class="container">
  <header>
    <h1>Bentok Lottere</h1>
    <p>HOTS Saintek Kedokteran PTN â€“ Mode Lotere Intens</p>
  </header>

  <div id="menu" class="menu">
    <button onclick="startLotere()">MULAI LOTERE (15 Soal â€“ 60 Detik/Soal)</button>
    <button onclick="if(confirm('Yakin keluar? Progress hilang.')) window.close();">Keluar</button>
  </div>

  <div id="game" class="game-area hidden">
    <div id="score-board">Skor: <span id="score">0</span> / 15</div>
    <div id="timer">Sisa waktu: <span id="time">60</span> detik</div>
    
    <div id="soal-text"></div>
    <div id="options" class="options"></div>
    
    <div id="feedback" class="hidden"></div>
    
    <div style="margin-top: 2rem;">
      <button id="nextBtn" onclick="nextQuestion()" class="hidden">Soal Selanjutnya â†’</button>
      <button id="backMenuBtn" onclick="backToMenu()" class="hidden">Kembali ke Menu</button>
    </div>
  </div>

  <footer>
    Tambah soal HOTS di array bankSoal (kode JS) â€¢ Semangat masuk Kedokteran PTN, Benyamin! ðŸ’‰
  </footer>
</div>

<script>
// BANK SOAL â€“ TAMBAH SOAL BARU DI SINI (target 50â€“100+ soal HOTS)
const bankSoal = [
  {
    soal: "Seorang pasien Rh- pernah hamil anak Rh+. Setelah transfusi darah Rh+ darurat, muncul hemolisis akut. Mekanisme imunologi utama adalah...",
    pilihan: [
      "A. IgM anti-A/B menyerang eritrosit donor",
      "B. IgG anti-Rh menginduksi hemolisis ekstravaskular",
      "C. Reaksi anafilaksis tipe I",
      "D. Kompleks imun tipe III di ginjal",
      "E. Sitotoksisitas sel T tipe IV"
    ],
    jawaban: "B",
    penjelasan: "Sensitasi Rh dari kehamilan sebelumnya â†’ IgG anti-Rh â†’ fagositosis ekstravaskular oleh makrofag limpa (hemolisis delayed/akut)."
  },
  {
    soal: "Pada ketoasidosis diabetik, anion gap meningkat karena akumulasi anion organik. Anion dominan yang menyebabkan ini adalah...",
    pilihan: [
      "A. Laktat",
      "B. Î²-hidroksibutirat",
      "C. Asam piruvat",
      "D. Klorida",
      "E. Bikarbonat"
    ],
    jawaban: "B",
    penjelasan: "Produksi badan keton (Î²-hidroksibutirat utama) â†’ asidosis metabolik high anion gap pada DKA."
  },
  {
    soal: "Mutasi Î”F508 pada cystic fibrosis menyebabkan protein CFTR tidak mencapai membran karena...",
    pilihan: [
      "A. Gangguan translasi",
      "B. Misfolding â†’ degradasi ER-associated (ERAD)",
      "C. Overekspresi chaperone",
      "D. Mutasi pada domain nuklear",
      "E. Gangguan splicing mRNA"
    ],
    jawaban: "B",
    penjelasan: "Î”F508 â†’ protein salah lipat â†’ diidentifikasi sebagai rusak â†’ didegradasi proteasome di retikulum endoplasma."
  },
  {
    soal: "Enzim kunci glukoneogenesis yang sangat diaktivasi glukagon (melalui penurunan fruktosa-2,6-bisfosfat) adalah...",
    pilihan: [
      "A. Glukokinase",
      "B. Fosfofruktokinase-1",
      "C. Fruktosa-1,6-bisfosfatase",
      "D. Piruvat kinase",
      "E. Glikogen fosforilase"
    ],
    jawaban: "C",
    penjelasan: "Fruktosa-1,6-bisfosfatase diaktivasi saat F2,6BP rendah (glukagon tinggi) â†’ memungkinkan glukoneogenesis berjalan."
  },
  {
    soal: "Keracunan metanol menyebabkan kebutaan karena metabolitnya menghambat enzim mitokondria. Metabolit toksik utama adalah...",
    pilihan: [
      "A. Formaldehida",
      "B. Asam format",
      "C. Metil glikolat",
      "D. Asam asetat",
      "E. Metanol langsung"
    ],
    jawaban: "B",
    penjelasan: "Metanol â†’ formaldehida â†’ asam format â†’ inhibisi sitokrom oksidase â†’ asidosis metabolik & toksisitas saraf optik."
  },
  // Tambahkan soal HOTS baru di sini (contoh pola di atas)
  // Contoh tambahan:
  {
    soal: "Pasien defisiensi G6PD mengonsumsi primaquine. Mekanisme hemolisis akut adalah...",
    pilihan: [
      "A. Penurunan ATP â†’ lisis membran",
      "B. Kurang NADPH â†’ kurang GSH â†’ stres oksidatif eritrosit",
      "C. Inhibisi langsung glikolisis",
      "D. Pembentukan methemoglobin dominan",
      "E. Reaksi autoimun"
    ],
    jawaban: "B",
    penjelasan: "Defisiensi G6PD â†’ jalur pentosa fosfat terganggu â†’ â†“ NADPH â†’ â†“ reduced glutathione â†’ kerusakan oksidatif â†’ hemolisis."
  }
  // ... tambah puluhan soal lagi sesuai kebutuhan (biologi klinis, metabolisme, imunologi, fisika medis, dll)
];

// Variabel game
let score = 0;
let totalAnswered = 0;
let usedQuestions = [];
let timerInterval = null;
let timeLeft = 60;

const menuEl      = document.getElementById("menu");
const gameEl      = document.getElementById("game");
const soalText    = document.getElementById("soal-text");
const optionsDiv  = document.getElementById("options");
const feedbackDiv = document.getElementById("feedback");
const nextBtn     = document.getElementById("nextBtn");
const backMenuBtn = document.getElementById("backMenuBtn");
const scoreEl     = document.getElementById("score");
const timeDisplay = document.getElementById("time");

// Fungsi bantu
function hideAll() {
  menuEl.classList.add("hidden");
  gameEl.classList.add("hidden");
  feedbackDiv.classList.add("hidden");
  nextBtn.classList.add("hidden");
  backMenuBtn.classList.add("hidden");
  clearInterval(timerInterval);
}

function showMenu() {
  hideAll();
  menuEl.classList.remove("hidden");
  resetGame();
}

function resetGame() {
  score = 0;
  totalAnswered = 0;
  usedQuestions = [];
  scoreEl.textContent = "0";
}

function startLotere() {
  if (bankSoal.length < 5) {
    alert("Bank soal terlalu sedikit! Tambah minimal 5 soal di kode JS.");
    return;
  }
  resetGame();
  hideAll();
  gameEl.classList.remove("hidden");
  totalAnswered = 0;
  nextQuestion();
}

function getRandomSoal() {
  if (usedQuestions.length >= bankSoal.length) usedQuestions = [];
  let idx;
  do {
    idx = Math.floor(Math.random() * bankSoal.length);
  } while (usedQuestions.includes(idx));
  usedQuestions.push(idx);
  return bankSoal[idx];
}

function nextQuestion() {
  if (totalAnswered >= 15) {
    endGame();
    return;
  }

  const soal = getRandomSoal();

  soalText.textContent = soal.soal;
  optionsDiv.innerHTML = "";

  soal.pilihan.forEach((opt, i) => {
    const letter = String.fromCharCode(65 + i); // A B C D E
    const div = document.createElement("div");
    div.className = "option";
    div.textContent = opt;
    div.dataset.letter = letter;
    div.onclick = () => selectAnswer(letter, soal.jawaban, soal.penjelasan);
    optionsDiv.appendChild(div);
  });

  feedbackDiv.classList.add("hidden");
  nextBtn.classList.add("hidden");
  backMenuBtn.classList.add("hidden");

  totalAnswered++;
  timeLeft = 60;
  timeDisplay.textContent = "60";
  timeDisplay.style.color = "var(--danger)";
  startTimer();
}

function startTimer() {
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    timeLeft--;
    timeDisplay.textContent = timeLeft;
    if (timeLeft <= 10) {
      timeDisplay.style.color = timeLeft <= 5 ? "#b91c1c" : "var(--warning)";
    }
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      showFeedback("WAKTU HABIS!", "time-up", "Klik 'Soal Selanjutnya' untuk lanjut");
      nextBtn.classList.remove("hidden");
      backMenuBtn.classList.remove("hidden");
    }
  }, 1000);
}

function selectAnswer(pilihanUser, jawabanBenar, penjelasan) {
  clearInterval(timerInterval);

  const benar = pilihanUser === jawabanBenar;
  if (benar) {
    score++;
    scoreEl.textContent = score;  // UPDATE SKOR REAL-TIME
  }

  // Highlight jawaban
  document.querySelectorAll(".option").forEach(opt => {
    opt.onclick = null;
    if (opt.dataset.letter === jawabanBenar) {
      opt.style.background = "var(--success)";
      opt.style.color = "white";
    }
    if (opt.dataset.letter === pilihanUser && !benar) {
      opt.style.background = "var(--danger)";
      opt.style.color = "white";
    }
  });

  let msg = benar ? "BENAR âœ“" : "SALAH âœ—";
  let cls = benar ? "correct" : "wrong";
  showFeedback(msg, cls, `Penjelasan: ${penjelasan || "Tidak ada penjelasan tambahan"}`);

  nextBtn.classList.remove("hidden");
  backMenuBtn.classList.remove("hidden");
}

function showFeedback(title, cls, text) {
  feedbackDiv.className = `feedback ${cls}`;
  feedbackDiv.innerHTML = `<strong>${title}</strong><br>${text}`;
  feedbackDiv.classList.remove("hidden");
}

function endGame() {
  clearInterval(timerInterval);
  soalText.innerHTML = "<h2>LOTERE SELESAI!</h2>";
  optionsDiv.innerHTML = "";
  feedbackDiv.innerHTML = `
    <strong>Skor Akhir: ${score} / 15</strong><br>
    Persentase: ${(score / 15 * 100).toFixed(1)}%<br><br>
    Terus latihan ya, Benyamin! Kamu pasti bisa tembus Kedokteran PTN impian ðŸ’ªðŸš€
  `;
  feedbackDiv.className = "feedback correct";
  feedbackDiv.classList.remove("hidden");
  nextBtn.classList.add("hidden");
  backMenuBtn.classList.remove("hidden");
}

function backToMenu() {
  if (confirm("Kembali ke menu? Progress lotere saat ini hilang.")) {
    showMenu();
  }
}

// Mulai
showMenu();
</script>
</body>
</html>
